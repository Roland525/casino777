<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lucky Box Casino</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="login-screen">
    <h1 class="neon-text">Lucky Box Casino</h1>
    <input type="text" id="nickname" placeholder="Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ½Ğ¸Ğº">
    <button id="login-btn">Ğ’Ğ¾Ğ¹Ñ‚Ğ¸</button>
  </div>

  <div id="game-screen" class="hidden">
    <header>
      <span id="user-name"></span>
      <span id="balance"></span>
      <button id="logout">Ğ’Ñ‹Ğ¹Ñ‚Ğ¸</button>
    </header>

    <nav>
      <button class="tab" data-tab="slots">Ğ¡Ğ»Ğ¾Ñ‚Ñ‹ ğŸ°</button>
      <button class="tab" data-tab="blackjack">Ğ‘Ğ»ÑĞºĞ´Ğ¶ĞµĞº ğŸƒ</button>
      <button class="tab" data-tab="roulette">Ğ ÑƒĞ»ĞµÑ‚ĞºĞ° ğŸ¡</button>
      <button class="tab" data-tab="mines">ĞœĞ¸Ğ½Ñ‹ ğŸ’£</button>
    </nav>

    <div id="content">
      <div id="slots" class="tab-content active">
        <h2>Ğ¡Ğ»Ğ¾Ñ‚Ñ‹ ğŸ°</h2>
        <button id="spin">ĞšÑ€ÑƒÑ‚Ğ¸Ñ‚ÑŒ</button>
        <p id="slots-result"></p>
      </div>

      <div id="blackjack" class="tab-content">
        <h2>Ğ‘Ğ»ÑĞºĞ´Ğ¶ĞµĞº ğŸƒ</h2>
        <button id="play-bj">Ğ˜Ğ³Ñ€Ğ°Ñ‚ÑŒ</button>
        <p id="bj-result"></p>
      </div>

      <div id="roulette" class="tab-content">
        <h2>Ğ ÑƒĞ»ĞµÑ‚ĞºĞ° ğŸ¡</h2>
        <button id="spin-roulette">ĞšÑ€ÑƒÑ‚Ğ¸Ñ‚ÑŒ Ñ€ÑƒĞ»ĞµÑ‚ĞºÑƒ</button>
        <p id="roulette-result"></p>
      </div>

      <div id="mines" class="tab-content">
        <h2>ĞœĞ¸Ğ½Ñ‹ ğŸ’£</h2>
        <button id="play-mines">Ğ˜Ğ³Ñ€Ğ°Ñ‚ÑŒ</button>
        <p id="mines-result"></p>
      </div>
    </div>
  </div>

  <script>
    const API_URL = "https://69147b693746c71fe0486c2c.mockapi.io/users"; // Ñ‚Ğ²Ğ¾Ğ¹ URL

    let currentUser = null;

    async function apiLogin(name) {
      const res = await fetch(`${API_URL}?name=${encodeURIComponent(name)}`);
      const data = await res.json();

      if (data.length > 0) {
        return data[0];
      } else {
        const newUser = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name, balance: 1000 })
        });
        return await newUser.json();
      }
    }

    async function apiSave(user) {
      await fetch(`${API_URL}/${user.id}`, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(user)
      });
    }

    document.getElementById("login-btn").addEventListener("click", async () => {
      const name = document.getElementById("nickname").value.trim();
      if (!name) return alert("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ½Ğ¸Ğº!");
      currentUser = await apiLogin(name);
      document.getElementById("user-name").textContent = `Ğ˜Ğ³Ñ€Ğ¾Ğº: ${currentUser.name}`;
      document.getElementById("balance").textContent = `Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ: ${currentUser.balance}ğŸ’°`;
      document.getElementById("login-screen").classList.add("hidden");
      document.getElementById("game-screen").classList.remove("hidden");
    });

    document.getElementById("logout").addEventListener("click", () => {
      location.reload();
    });

    // --- ĞĞ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ ---
    document.querySelectorAll(".tab").forEach(btn => {
      btn.addEventListener("click", () => {
        document.querySelectorAll(".tab-content").forEach(tab => tab.classList.remove("active"));
        document.getElementById(btn.dataset.tab).classList.add("active");
      });
    });

    // --- Ğ˜Ğ³Ñ€Ñ‹ ---
    document.getElementById("spin").addEventListener("click", async () => {
      if (!currentUser) return;
      const win = Math.random() < 0.3;
      const res = document.getElementById("slots-result");
      res.textContent = win ? "Ğ’Ñ‹ Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»Ğ¸ 200!" : "Ğ’Ñ‹ Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ñ€Ğ°Ğ»Ğ¸ 100!";
      currentUser.balance += win ? 200 : -100;
      document.getElementById("balance").textContent = `Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ: ${currentUser.balance}ğŸ’°`;
      await apiSave(currentUser);
    });

    document.getElementById("play-bj").addEventListener("click", async () => {
      if (!currentUser) return;
      const win = Math.random() < 0.45;
      const res = document.getElementById("bj-result");
      res.textContent = win ? "Ğ’Ñ‹ Ğ²Ñ‹Ğ¸Ğ³Ñ€Ğ°Ğ»Ğ¸ 150!" : "Ğ’Ñ‹ Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ñ€Ğ°Ğ»Ğ¸ 100!";
      currentUser.balance += win ? 150 : -100;
      document.getElementById("balance").textContent = `Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ: ${currentUser.balance}ğŸ’°`;
      await apiSave(currentUser);
    });

    document.getElementById("spin-roulette").addEventListener("click", async () => {
      if (!currentUser) return;
      const win = Math.random() < 0.4;
      const res = document.getElementById("roulette-result");
      res.textContent = win ? "Ğ ÑƒĞ»ĞµÑ‚ĞºĞ° â€” Ğ²Ñ‹Ğ¸Ğ³Ñ€Ñ‹Ñˆ 300!" : "Ğ£Ğ²Ñ‹, Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ñ€Ñ‹Ñˆ...";
      currentUser.balance += win ? 300 : -150;
      document.getElementById("balance").textContent = `Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ: ${currentUser.balance}ğŸ’°`;
      await apiSave(currentUser);
    });

    document.getElementById("play-mines").addEventListener("click", async () => {
      if (!currentUser) return;
      const win = Math.random() < 0.2;
      const res = document.getElementById("mines-result");
      res.textContent = win ? "Ğ’Ñ‹ Ğ½Ğ°ÑˆĞ»Ğ¸ Ğ·Ğ¾Ğ»Ğ¾Ñ‚Ğ¾ ğŸ’ +500!" : "Ğ’Ğ·Ğ¾Ñ€Ğ²Ğ°Ğ»Ğ¸ÑÑŒ ğŸ’¥ -250!";
      currentUser.balance += win ? 500 : -250;
      document.getElementById("balance").textContent = `Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ: ${currentUser.balance}ğŸ’°`;
      await apiSave(currentUser);
    });
  </script>
</body>
</html>
